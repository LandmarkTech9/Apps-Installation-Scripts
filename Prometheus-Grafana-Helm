#Installing Helm 3
==================
#Download the latest helm 3 installation script
# https://helm.sh/docs/intro/install/ 
curl -fsSL -o get_helm.sh 
https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3

#Add execute permissions to the downloaded script & run.
 chmod 700 get_helm.sh
 ./get_helm.sh

#Validate helm installation by executing the helm command.
# vi /etc/sudoers 
helm
Hub.helm.sh

==========================================================
#Deploy Prometheus, Exporters, Alert Manager & Grafana
==========================================================
https://docs.aws.amazon.com/eks/latest/userguide/prometheus.html
pls create persistentvolume or edith value.yml file and change
   1. persistent volume for prometheus-alertmanager = false (line 201)
   2. persistent volume for prometheus-server = false (line 912)
   3. atertmanager ingress = true  (line 115) 125 139
      prometheus-server = true  (line 825)
      or
   3. also install ingress
  
  
apiVersion: extensions/v1beta1  # networking.k8s.io/v1
kind: Ingress
metadata:
  name: ingress-resource-1
  namespace: prometheus
spec:
  ingressClassName: nginx
  rules:
  - host: alertmanager.ntech.k8.local
    http:
      paths:
      - backend:
          serviceName: prometheus-alertmanager
          servicePort: 80
  - host: prometheus.ntech.k8.local
    http:
      paths: 
      - backend:
          serviceName: prometheus-server
          servicePort: 80

1. #Create a namespace in which will deploy Prometheus & itâ€™s components
kubectl create ns apm

2. #Add helm repo which contains Prometheus and Grafana charts
helm repo add apm "https://charts.helm.sh/stable"
helm repo update
helm repo ls
helm search repo apm
helm search repo apm | grep prometheus
#use the first chat in the search with name apm/prometheus 
#check the template if you want
helm template apm/prometheus

3. #To make changes 
helm show values apm/prometheus
#Get prometheus values
helm show values apm/prometheus >> prometheusvalues.yml

4. #Update prometheusvalues.yml file to update service types and add alert rules & SMTP details.

5. Deploy using helm with updated values file.
#helm install prometheus apm/prometheus -n apm -f prometheusvalues.yml

6. Get Grafana values file

