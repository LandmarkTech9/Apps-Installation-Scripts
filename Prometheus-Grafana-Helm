#Installing Helm 3
==================
#Download the latest helm 3 installation script
# https://helm.sh/docs/intro/install/ 
curl -fsSL -o get_helm.sh 
https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3

#Add execute permissions to the downloaded script & run.
 chmod 700 get_helm.sh
 ./get_helm.sh

#Validate helm installation by executing the helm command.
# vi /etc/sudoers 
helm
Hub.helm.sh

=========================================================
  also install ingress run
===============================================================
https://kubernetes.github.io/ingress-nginx/user-guide/monitoring/
helm upgrade --install ingress-nginx ingress-nginx \
  --repo https://kubernetes.github.io/ingress-nginx \
  --namespace ingress-nginx --create-namespace
  
  helm upgrade --install ingress-nginx ingress-nginx \
  --repo https://kubernetes.github.io/ingress-nginx \
  --namespace prometheus
  
#The controller should be configured for exporting metrics. This requires 3 configurations to the controller. These configurations are :

#controller.metrics.enabled=true
#controller.podAnnotations."prometheus.io/scrape"="true"
#controller.podAnnotations."prometheus.io/port"="10254"
run
helm upgrade ingress-nginx ingress-nginx \
--repo https://kubernetes.github.io/ingress-nginx \
--namespace prometheus \
--set controller.metrics.enabled=true \
--set-string controller.podAnnotations."prometheus\.io/scrape"="true" \
--set-string controller.podAnnotations."prometheus\.io/port"="10254"

You can validate that the controller is configured for metrics by looking at the values of the installed release, like this:

helm get values ingress-nginx --namespace prometheus
You should be able to see the values shown below:

..
controller:
  metrics:
    enabled: true
    service:
      annotations:
        prometheus.io/port: "10254"
           prometheus.io/scrape: "true"



==========================================================
#Deploy Prometheus, Exporters, Alert Manager & Grafana
==========================================================
https://docs.aws.amazon.com/eks/latest/userguide/prometheus.html

  
  

     
        




1. #Create a namespace in which will deploy Prometheus & itâ€™s components
kubectl create ns apm

2. #Add helm repo which contains Prometheus and Grafana charts
helm repo add apm "https://charts.helm.sh/stable"
helm repo update
helm repo ls
helm search repo apm
helm search repo apm | grep prometheus
#use the first chat in the search with name apm/prometheus 
#check the template if you want
helm template apm/prometheus

3. #To make changes 
helm show values apm/prometheus
#Get prometheus values
helm show values apm/prometheus >> prometheusvalues.yml

4. #Update prometheusvalues.yml file to update service types and add alert rules & SMTP details.

5. Deploy using helm with updated values file.
#helm install prometheus apm/prometheus -n apm -f prometheusvalues.yml

6. Get Grafana values file

